<!DOCTYPE html>
<html lang="en" dir="ltr">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Mouse Path Game</title>
  <style media="screen">
    #container {
      width: 100%;
      height: 100%;
      position: fixed;
    }

    .box {
      height: 100px;
      width: 100px;
      background-image: url('http://fillmurray.com/100/100');
      border: 1px solid black;
      position: absolute;
    }

    .specialBox {
      background-image: url('http://fillmurray.com/200/200');
      background-position: top;
      z-index: 1;
    }

    .modal {
      position: absolute;
      display: none;
      width: 300px;
      height: 300px;
      background-color: grey;
      z-index: 10;
    }
  </style>
</head>

<body>
  <div id="container"></div>

  <div id="winGame" class="modal">
    <h2>You rock</h2>
    <button type="button" class="tryAgain">Try Again</button>
  </div>

  <div id="loseGame" class="modal">
    <h2>You suck</h2>
    <button type="button" class="tryAgain">Try Again</button>
  </div>
  <script type="text/javascript">
    //Get the container element and assign it to a variable
    var container = document.getElementById('container');

    //Get modal dom elements
    var modals = document.getElementsByClassName('modal');
    //Get the loseGame div modal
    var loseGameModal = document.getElementById('loseGame');
    //Get the winGame div modal
    var winGameModal = document.getElementById('winGame');
    //Get the tryAgain buttons
    var tryAgainButton = document.getElementsByClassName('tryAgain');
    //Assign event listener to try again buttons
    for (var i = 0; i < tryAgainButton.length; i++) {
      tryAgainButton[i].addEventListener('click', reloadPage);
    }

    // Create variable for n using prompt input
    var n = prompt('Enter a number');
    // Parse input into an integer
    n = parseInt(n);

    //Generate random number function
    function getSpecialBoxIndex(num) {
      var ranNum = Math.floor(Math.random() * num - 1);
      console.log(ranNum);
      return ranNum;
    }

    //Generate and assign random number to specialBoxIndex
    var specialBoxIndex = getSpecialBoxIndex(n);

    // Place random boxes function
    function placeRandomBoxes(num) {
      var divHTML = '';
      for (var i = 0; i < n; i++) {
        if (i == specialBoxIndex) {
          divHTML += '<div class="box specialBox"></div>';
        } else {
          divHTML += '<div class="box"></div>';
        }

      }
      container.innerHTML = divHTML;
      var box = document.getElementsByClassName('box');
      console.log(box.length);

      for (var i = 0; i < box.length; i++) {
        var x = Math.floor(Math.random() * 500);
        x += 'px';
        var y = Math.floor(Math.random() * 500);
        y += 'px';

        box[i].style.top = x;
        box[i].style.left = y;

        if (i == specialBoxIndex) {
          box[i].addEventListener('mouseover', winGame);
        } else {
          box[i].addEventListener('mouseover', loseGame);
        }
      }
    }
    // Call random box function
    placeRandomBoxes(n);

    function winGame() {
      winGameModal.style.display = 'block';
      removeEventListeners();

    }

    function loseGame() {
      loseGameModal.style.display = 'block';

      removeEventListeners();
    }

    //Remove the event listeners on game end
    function removeEventListeners() {
      var box = document.getElementsByClassName('box');
      box[specialBoxIndex].removeEventListener('mouseover', winGame);
      for (var i = 0; i < box.length; i++) {
        box[i].removeEventListener('mouseover', loseGame);
      }
    }

    //Reload page functions
    function reloadPage() {
      for (var i = 0; i < modals.length; i++) {
        modals[i].style.display = 'none';
      }
      location.reload();
    }
  </script>
</body>

</html>